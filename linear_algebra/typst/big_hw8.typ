#import "../../exam_template.typ": *
#import "../../typst-sympy-calculator.typ": *
#import "@preview/pyrunner:0.1.0" as py
#import "../../gause_algo.typ": *
#let title = "ИДЗ 8"
#let author = "Гольдберг Дмитрий Максимович"
#let course = "Линейная алгебра и геометрия"
#let group = "Группа БПМИ248"
#show: title_page.with(title, author, course, group)
#show: template

#problem(name: 1)[
Дополните вектор $v=1/13 (-4, -9, -6,6)$ до ортонормированного базиса в $RR^4$.
]
#solution[
Найдем базис ортогонального дополнения к $v$. Ищем ФСР для ОСЛУ
$
  mat(-4,-9,-6,6) => "УСВ:" #isv(array(((-4,-9,-6,6),))) => "ФСР:" mat(3/2;0;0;1),mat(-3/2;0;1;0),mat(-9/4;1;0;0)
$
Ортогонализуем этот набор векторов
$
  f_1=(3/2,0,0,1)\
  f_2 = (-3/2,0,1,0) - ((-3/2,0,1,0),(3/2,0,0,1))/((3/2,0,0,1),(3/2,0,0,1)) dot (3/2,0,0,1)=(0,0,1,1)\
  f_3 = (-9/4,1,0,0) - ((-9/4,1,0,0),(3/2,0,0,1))/((3/2,0,0,1),(3/2,0,0,1)) dot (3/2,0,0,1) - ((-9/4,1,0,0),(0,0,1,1))/((0,0,1,1),(0,0,1,1)) dot (0,0,1,1)=\
  =(0,1,0,3/2)
$
]
#answer[
$
  1/13 (-4,-9,-6,6),2/sqrt(13) (3/2,0,0,1),1/sqrt(2) (0,0,1,1),2/sqrt(13) (0,1,0,3/2)
$
]
#pagebreak()

#problem(name: 2)[
Подпространство $U$ евклидова пространства $RR^4$ задано системой уравнений
$
  cases(4x_1+2x_2+2x_3-4x_4=0,-x_1+4x_2+4x_3+x_4=0).
$
Для вектора $v=(-4,4,0,-2)$ найдите его проекцию на $U$, его ортогональную составляющую относительно $U$ и расстояние от него до $U$.
]
#solution[
  Найдем ФСР для исходной ОСЛУ
$
  mat(4,2,2,-4;-1,4,4,1) => "УСВ:" #isv(array(((4,2,2,-4),(-1,4,4,1)))) => "ФСР:" mat(1;0;0;1),mat(0;-1;1;0) =>\
  => U=linspan(mat(1;0;0;1),mat(0;-1;1;0))
$
$
  A=mat(1,0;0,-1;0,1;1,0) => "pr"_U v = A dot (A^T dot A)^(-1) dot A^T dot v=(-3,2,-2,-3) =>\
  "ort"_U v = (-1,2,2,1) => abs("ort"_U v)=sqrt(10)
$
]
#answer[
$
  (-3,2,-2,-3),(-1,2,2,1), sqrt(10)
$
]
#pagebreak()
#problem(name: 3)[
В евклидовом пространстве $RR^4$, даны два подпространства $U=linspan(u_1,u_2)$ и $W=linspan(w_1,w_2)$, где $u_1=(1,2,2,1),u_2=(1,-3,-3,1),w_1=(1,2,2,-1),w_2=(1,-1,-3,3)$. Найти вектор $v$ для которого $"pr"_U v =(-10,0,0,-10)$ и $"ort"_W v=(6,0,-8,-10)$.
]
#solution[
Обозначим искомый вектор за $x$. Найдем его проекцию на $U$.
$
  A=mat(1,1;2,-3;2,-3;1,1) => A dot (A^T dot A)^(-1) dot A^T dot x = (-10,0,0,-10)\
  mat(1/2,0,0,1/2;0,1/2,1/2,0;0,1/2,1/2,0;1/2,0,0,1/2) dot x = (-10,0,0,-10) <==> cases(x_1+x_4=-20,x_2+x_3=0)
$
Найдем ортогональную составляющую относительно $W$
$
  A=mat(1,1;2,-1;2,-3;-1,3) =>A dot (A^T dot A)^(-1) dot A^T dot x = x - (6,0,-8,-10)\
  mat(1/2,2/5,0,3/10;2/5,1/2,3/10,0;0,3/10,1/2,-2/5;3/10,0,-2/5,1/2) dot x = x - (6,0,-8,-10)\
  mat(1/2,2/5,0,3/10;2/5,1/2,3/10,0;0,3/10,1/2,-2/5;3/10,0,-2/5,1/2) dot x - x = (-6,0,8,10)\
  (mat(1/2,2/5,0,3/10;2/5,1/2,3/10,0;0,3/10,1/2,-2/5;3/10,0,-2/5,1/2) - E) dot x = (-6,0,8,10)\
  mat(-1/2,2/5,0,3/10;2/5,-1/2,3/10,0;0,3/10,-1/2,-2/5;3/10,0,-2/5,-1/2) dot x = (-6,0,8,10) <==> cases(x_1-4/3 x_3-5/3 x_4=100/3,x_2-5/3 x_3-4/3 x_4=80/3)
$
Пересекая две полученные системы, получаем, что
$(x_1,x_2,x_3,x_4)=(0,0,0,-20)$.
]
#answer[
  $
    (0,0,0,-20)
  $
]
#pagebreak()
#problem(name: 4)[
В пространстве $V=RR [x]_(<=2)$, снабжённом структурой евклидова пространства относительно некоторого скалярного произведения, объём параллелепипеда, натянутого на векторы $-4+5x-x^2,16-18x+3x^2,8-14x+3x^2,$ равен 5. Найти объём параллелепипеда, натянутого на векторы $-3+3x-4x^2,-3-x-7x^2,6-9x+10x^2$.
]
#solution[
Перейдем к координатам в $RR^3$, тогда первая система векторов имеет вид
$
  A=mat(-4, 16,8;5,-18,-14;-1,3,3)
$
Вторая система векторов имеет вид
$
  B=mat(-3,-3,6;3,-1,-9;-4,-7,10)
$
$
  G_A = A^T dot A\
  "Vol" A = sqrt(det(G_A))=sqrt(det(A^T dot A))=5
$
Найдем матрицу перехода между заданными базисами
$
  A dot C = B =>\
  C=mat(71/2,155/2,-82;55/8,119/8,-65/4;29/8,69/8,-31/4)\
  "Vol" B = sqrt(det(G_B))=sqrt(det(B^ T dot B))=sqrt(det(C^T dot A^T dot A dot C))=sqrt(det(A^T dot A)) dot sqrt(det(C^T dot C))\
   => "Vol"B=5 dot 51/8 =255/8
$
]
#answer[
$
255/8
$
]
#pagebreak()

#problem(name: 5)[
Пусть $L-$ трёхмерная плоскость в $RR^5$, проходящая через точки $v_0=(2,3,8,-7,-6),v_1=(3,10,0,-11,-13),v_2=(-2,-4,8,-8,-13),v_3=(-5,4,8,-14,-2)$. Найдите в $L$ точку, ближайшую к точке $v=(-8,1,0,-10,-2)$, и расстояние от неё до $v$.
]
#solution[
  Зададим $L$ как линейное многообразие
  $
    L=v_0+linspan(v_1-v_0,v_2-v_0,v_3-v_0)\
    v_1-v_0=(1,7,-8,-4,-7)\
    v_2-v_0=(-4,-7,0,-1,-7)\
    v_3-v_0=(-7,1,0,-7,4)
  $
Тогда искомое расстояние от линейного многообразия до $v$ есть расстояние от вектора $v-v_0=(-10,-2,-8,-3,4)$ до $U=linspan(v_1-v_0,v_2-v_0,v_3-v_0)$
$
  A=mat(1,-4,-7;7,-7,1;-8,0,0;-4,-1,-7;-7,-7,4)\
  "pr"_U v-v_0=A dot (A^T dot A)^(-1) dot A^T dot (v-v_0)=mat(-1216/179;208/179;1432/179;-1314/179;-1018/179)
$
Тогда ближайшая точка в $L$ есть $p=v_0+"pr"_U v-v_0=(-858/179,745/179,2864/179,-2567/179,-2092/179)$, а искомое расстояние есть $abs(abs(v-p))=sqrt(11955357)/179$.
]
#answer[
  $
    (-858/179,745/179,2864/179,-2567/179,-2092/179), sqrt(11955357)/179
  $
]
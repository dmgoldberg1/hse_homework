#import "../../exam_template.typ": *
#import "../../typst-sympy-calculator.typ": *
#import "@preview/pyrunner:0.1.0" as py
#import "../../gause_algo.typ": *
#let title = "ДЗ 30"
#let author = "Гольдберг Дмитрий Максимович"
#let course = "Линейная алгебра и геометрия"
#let group = "Группа БПМИ248"
#show: title_page.with(title, author, course, group)
#show: template

#problem(name: 1)[
Пусть $V-$ евклидово пространство и $phi:V arrow V-$ некоторое отображение, причём
$
  (phi(u),phi(v))=(u,v)
$
для всех $u,v in V$. Доказать, что $phi$ линейно, а значит является ортогональным оператором на $V$.
]
#solution[
Заметим, что $abs(abs(phi(u)))=abs(abs(u)) space forall u in V$(следует из сохранения скалярного произведения)
$
  abs(abs(phi(u + v) -phi(u)-phi(v)))^2=(phi(u + v) -phi(u)-phi(v), phi(u + v) -phi(u)-phi(v))=\
  =("раскрываем по линейности и пользуемся свойством из условия")=abs(abs(u+v))^2-abs(abs(u))^2-\
  -abs(abs(v))^2-2(u,v)=0 =>\
  =>phi(u + v)=phi(u)+phi(v)\
  "Остаётся доказать, что "abs(abs(phi(lambda v) - lambda phi(v)))^2 = 0. "Доказывается аналогично предыдущему пункту,"\
  "то есть раскрываем по линености скалярное произведение и получаем 0".\
  => "Отображение линейное"
$
]
#answer[
ч.т.д
]

#pagebreak()

#problem(name: 2)[
Доказать, что если два вектора $u, v$ в евклидовом пространстве $V$ имеют одинаковую длину, то существует ортогональный оператор $Alpha$ на $V$, переводящий $u$ в $v$.
]
#solution[
Пусть $display(u^prime = u/abs(abs(u)))$, дополним $u^prime$ до ортонормированного базиса в $V$. Так как оператор ортогональный, то образы нормированных вектор также образуют ортонормированный базис, также он сохраняет длины векторов. Пусть $display(phi(u^prime)=v/abs(abs(v)))$. Так как у векторов одинаковые длины по условию, то такое отображение корректно. Образых остальных векторов могут быть тождественными. Таким образом мы указали образы базисных векторов, то есть построили оператор. Доказано.
]
#answer[
ч.т.д
]

#pagebreak()

#problem(name: 3)[
Найти канонический вид и соответствующую ортогональную замену для ортогональной матрицы
$
  A=mat(2/3,2/3,-1/3;2/3,-1/3,2/3;-1/3,2/3,2/3)
$
]
#solution[
$
  chi(t)=-1 dot det(mat(2/3 -t,2/3,-1/3;2/3,-1/3-t,2/3;-1/3,2/3,2/3-t))=t^3-t^2-t+1=(t -1)^2(t+1)=>1;-1-"соб. значения"\
  A v = 1 v\
  (A - E)v=0\
  mat(-1/3,2/3,-1/3;2/3,-4/3,2/3;-1/3,2/3,-1/3) => "УСВ:" mat(1, -2, 1;0,0,0;0,0,0) => "ФСР:" mat(-1;0;1),mat(2;1;0)\
  "ортогонализуем этот наборчик"\
  f_1=(-1,0,1)\
  f_2=(2,1,0) - (((2,1,0),(-1,0,1)))/(((-1,0,1),(-1,0,1)))(-1,0,1)=(2,1,0)+(-1,0,1)=(1,1,1)\
  A v = -1 v\
  (A+E)v=0\
  mat(5/3,2/3,-1/3;2/3,2/3,2/3;-1/3,2/3,5/3) =>"УСВ:" mat(1,0,-1;0,1,2;0,0,0) =>"ФСР:" mat(1;-2;1)\
  => "канонический вид: " mat(1,0,0;0,1,0;0,0,-1)\
  "ортогональная замена": mat(x_1;x_2;x_3)=mat(-1,1,1;0,1,-2;1,1,1) mat(y_1;y_2;y_3)
$
]
#answer[
$
  mat(1,0,0;0,1,0;0,0,-1)\
  mat(x_1;x_2;x_3)=mat(-1,1,1;0,1,-2;1,1,1) mat(y_1;y_2;y_3)
$
]
#pagebreak()

#problem(name: 4)[
  Найти канонический вид и соответствующую ортогональную замену для ортогональной матрицы
$
  A=mat(1/2,1/2,-sqrt(2)/2;1/2,1/2,sqrt(2)/2;sqrt(2)/2,-sqrt(2)/2,0)
$
]
#solution[
$
  chi(t)=-1 dot det(mat(1/2-t,1/2,-sqrt(2)/2;1/2,1/2-t,sqrt(2)/2;sqrt(2)/2,-sqrt(2)/2,0-t))=t^3-t^2+t-1=(t-1)(t^2+1)=>1-"соб. значение"\
  A v = 1v\
  (A -E)v=0\
  mat(-1/2,1/2,-sqrt(2)/2;1/2,-1/2,sqrt(2)/2;sqrt(2)/2,-sqrt(2)/2,-1)=>"УСВ:" mat(1,-1,0;0,0,1;0,0,0) =>"ФСР:" mat(1;1;0)\
  =>e_0 = 1/sqrt(2) mat(1;1;0)\
  e_1 perp e_0 => e_1 = 1/sqrt(2)mat(-1;1;0)\
  e_2 = [e_0, e_1]=mat(0;0;1)\
  cos alpha = (A e_1, e_1)=0\
  sin alpha =(A e_1,e_2)=((0,0,-1),(0,0,1))=-1\
  =>"канонический вид:" mat(1,0,0;0,0,1;0,-1,0)\
  "ортогональная замена": mat(x_1;x_2;x_3)=mat(1/sqrt(2),-1/sqrt(2),0;1/sqrt(2),1/sqrt(2),0;0,0,1) mat(y_1;y_2;y_3)
$
]
#answer[
$
mat(1,0,0;0,0,1;0,-1,0)\
mat(x_1;x_2;x_3)=mat(1/sqrt(2),-1/sqrt(2),0;1/sqrt(2),1/sqrt(2),0;0,0,1) mat(y_1;y_2;y_3)
$
]
#pagebreak()

#problem(name: 5)[
Найти канонический вид и соответствующую ортогональную замену для ортогональной матрицы
$
  A=mat(3/7,-2/7,6/7;6/7,3/7,-2/7;-2/7,6/7,3/7)
$
]
#solution[
$
  chi(t)=-1 dot det(mat(3/7-t,-2/7,6/7;6/7,3/7-t,-2/7;-2/7,6/7,3/7-t))=t^3-9/7t^2+9/7t-1=1/7(t-1)(7t^2-2t+7)=>1-"соб. значение"\
  A v = 1 v\
  (A - E)v=0\
  mat(-4/7,-2/7,6/7;6/7,-4/7,-2/7;-2/7,6/7,-4/7) =>"УСВ:" mat(1,0,-1;0,1,-1;0,0,0) =>"ФСР:" mat(1;1;1)\
  e_0 = 1/sqrt(3) mat(1;1;1)\
  e_1 perp e_0 => e_1=1/sqrt(2)mat(1;0;-1)\
  e_2=[e_0,e_1]=1/sqrt(6)mat(-1;2;-1)\
  cos alpha = (A e_1, e_1)=1/7\
  sin alpha = (A e_1, e_2)=8/(7sqrt(3))\
  =>"канонический вид:" mat(1,0,0;0,1/7,-8/(7sqrt(3));0,8/(7sqrt(3)),1/7)\
  "ортогональная замена": mat(x_1;x_2;x_3)=mat(1/sqrt(3),1/sqrt(2),-1/sqrt(6);1/sqrt(3),0,2/sqrt(6);1/sqrt(3),-1/sqrt(2),-1/sqrt(6)) mat(y_1;y_2;y_3)
$
]
#answer[
$
  mat(1,0,0;0,1/7,-8/(7sqrt(3));0,8/(7sqrt(3)),1/7)\
  mat(x_1;x_2;x_3)=mat(1/sqrt(3),1/sqrt(2),-1/sqrt(6);1/sqrt(3),0,2/sqrt(6);1/sqrt(3),-1/sqrt(2),-1/sqrt(6)) mat(y_1;y_2;y_3)
$
]
#pagebreak()

#problem(name: 6)[
Ортогональный оператор $Alpha$ на $RR^3$ в стандартном базисе имеет матрицу
$
  1/3mat(-2,-2,1;-2,1,-2;-1,2,2).
$
Найти ортонормированный базис, в котором матрица оператора $Alpha$ имеет канонический вид и выписать эту матрицу. Указать ось и угол поворота, определяемого оператором $Alpha$.
]
#solution[
$
  chi(t)=-1 dot det(mat(-2/3-t,-2/3,1/3;-2/3,1/3-t,-2/3;-1/3,2/3,2/3-t))=t^3-1/3t^2-1/3t+1=1/3(t+1)(3t^2-4t+3)=>-1-"соб. значение"\
  A v = -1v\
  (A+E)v=0\
  mat(1/3,-2/3,1/3;-2/3,4/3,-2/3;-1/3,2/3,5/3)=>"УСВ:" mat(1,-2,0;0,0,1;0,0,0) =>"ФСР:" mat(2;1;0)
  $
  $
  e_0=1/sqrt(5) mat(2;1;0)\
  e_1 perp e_0 =>e_1=1/sqrt(5)mat(-1;2;0)\
  e_2 = [e_0, e_1]=mat(0;0;1)\
  cos alpha = (A e_1, e_1)=2/3\
  sin alpha = (A e_1, e_2)=sqrt(5)/3\
  =>"канонический вид:" mat(-1,0,0;0,2/3,-sqrt(5)/3;0,sqrt(5)/3,2/3)\
  {e_0,e_1,e_2}-"искомый базис"\
  alpha=arccos(2/3)\
  "ось вращения"-linspan((2,1,0))
$
]
#answer[
см. решение
]
#pagebreak()

#problem(name: 7)[
Найти полное и усечённое сингулярные разложения матрицы $A=display(mat(3,2,4;1,4,-2))$ с семинара, используя матрицу $A^T A$.
]
#solution[
$
  A^T A=mat(10,10,10;10,20,0;10,0,20)\
  chi(t)=-1 dot det(mat(10-t,10,10;10,20-t,0;10,0,20-t))=t^3-50t^2+600t=t(t-20)(t-30)=>0;20;30-"соб. значения"\
  A v =20v\
  (A - 20E)v=0\
  mat(-10,10,10;10,0,0;10,0,0)=>"УСВ:" #isv(array(((-10,10,10),(10,0,0),(10,0,0)))) =>"ФСР:" mat(0;-1;1)=>v_2=mat(0;-1/sqrt(2);1/sqrt(2))\
  A v = 30v\
  (A-30E)v=0\
  mat(-20,10,10;10,-10,0;10,0,-10) =>"УСВ:" #isv(array(((-20,10,10),(10,-10,0),(10,0,-10)))) =>"ФСР:" mat(1;1;1) =>v_1=mat(1/sqrt(3);1/sqrt(3);1/sqrt(3))
  $
  $
  sigma_2=sqrt(20)\
  sigma_1=sqrt(30)\
  =>Sigma =mat(sqrt(30),0,0;0,sqrt(20),0)\
  V = mat(1/sqrt(3),0;1/sqrt(3),-1/sqrt(2);1/sqrt(3),1/sqrt(2))\
  u_1 = (A v_1)/sigma_1=mat((3sqrt(10))/10;sqrt(10)/10)\
  u_2=(A v_2)/sigma_2=mat(sqrt(10)/10;-(3sqrt(10))/10)\
  => U=mat((3sqrt(10))/10, sqrt(10)/10;sqrt(10)/10, -(3sqrt(10))/10)\
  =>A = mat((3sqrt(10))/10, sqrt(10)/10;sqrt(10)/10, -(3sqrt(10))/10)mat(sqrt(30),0;0,sqrt(20))mat(1/sqrt(3),1/sqrt(3),1/sqrt(3);0,-1/sqrt(2),1/sqrt(2))-"усеченное разложение"\
  "Для полного свд надо дополнить систему" v" вектором" v_3 in linspan(u_1,u_2)^perp\
  v_3 = mat(-2/sqrt(6),1/sqrt(6), 1/sqrt(6))
$
$
  A=mat((3sqrt(10))/10, sqrt(10)/10;sqrt(10)/10, -(3sqrt(10))/10)mat(sqrt(30),0,0;0,sqrt(20),0)mat(1/sqrt(3),1/sqrt(3),1/sqrt(3);0,-1/sqrt(2),1/sqrt(2);-2/sqrt(6),1/sqrt(6), 1/sqrt(6))-"полное разложение"
$

]
#answer[
$
  A = mat((3sqrt(10))/10, sqrt(10)/10;sqrt(10)/10, -(3sqrt(10))/10)mat(sqrt(30),0;0,sqrt(20))mat(1/sqrt(3),1/sqrt(3),1/sqrt(3);0,-1/sqrt(2),1/sqrt(2))\
  A=mat((3sqrt(10))/10, sqrt(10)/10;sqrt(10)/10, -(3sqrt(10))/10)mat(sqrt(30),0,0;0,sqrt(20),0)mat(1/sqrt(3),1/sqrt(3),1/sqrt(3);0,-1/sqrt(2),1/sqrt(2);-2/sqrt(6),1/sqrt(6), 1/sqrt(6))
$
]
#pagebreak()
#problem(name: 8)[
Найти полное и усечённое сингулярные разложения матрицы $A=display(mat(-5,3,5;5,-1,5))$.
]
#solution[
$
  A^T A =mat(50,-20,0;-20,10,10;0,10,50)\
  chi(t)=-1 dot det(mat(50-t,-20,0;-20,10-t,10;0,10,50-t))=t^3-110t^2+3000t=t(t-50)(t-60)\
  => sigma_1=sqrt(60),sigma_2=sqrt(50)\
  =>Sigma = mat(sqrt(60),0,0;0,sqrt(50),0)\
  A v = 60v\
  (A - 60E)v=0\
  mat(-10,-20,0;-20,-50,10;0,10,-10)=>"УСВ:" #isv(array(((-10,-20,0),(-20,-50,10),(0,10,-10))))=>"ФСР:" mat(-2;1;1)=>v_1=mat(-2/sqrt(6);1/sqrt(6);1/sqrt(6))\
  A v = 50v\
  (A - 50E)v=0\
  mat(0,-20,0;-20,-40,10;0,10,0) =>"УСВ:" #isv(array(((0,-20,0),(-20,-40,10),(0,10,0)))) =>"ФСР:" mat(1;0;2) =>v_2=mat(1/sqrt(5);0;2/sqrt(5))\
  =>V=mat(-2/sqrt(6),1/sqrt(5);1/sqrt(6),0;1/sqrt(6),2/sqrt(5))\
  u_1=mat((3sqrt(10))/10;-sqrt(10)/10)\
  u_2=mat(sqrt(10)/10;(3sqrt(10))/10)\
  =>U=mat((3sqrt(10))/10, sqrt(10)/10;-sqrt(10)/10, (3sqrt(10))/10)
$
$
  A=mat((3sqrt(10))/10, sqrt(10)/10;-sqrt(10)/10, (3sqrt(10))/10)mat(sqrt(60),0;0,sqrt(50))mat(-2/sqrt(6),1/sqrt(6),1/sqrt(6);1/sqrt(5),0,2/sqrt(5))-"усечённое разложение"\
  v_3 = mat(2/sqrt(30);5/sqrt(30);-1/sqrt(30))\
  A=mat((3sqrt(10))/10, sqrt(10)/10;-sqrt(10)/10, (3sqrt(10))/10)mat(sqrt(60),0,0;0,sqrt(50),0) mat(-2/sqrt(6),1/sqrt(6),1/sqrt(6);1/sqrt(5),0,2/sqrt(5);2/sqrt(30),5/sqrt(30),-1/sqrt(30))-"полное разложение"
$
]
#answer[
$
  A=mat((3sqrt(10))/10, sqrt(10)/10;-sqrt(10)/10, (3sqrt(10))/10)mat(sqrt(60),0;0,sqrt(50))mat(-2/sqrt(6),1/sqrt(6),1/sqrt(6);1/sqrt(5),0,2/sqrt(5))-"усечённое разложение"\
  A=mat((3sqrt(10))/10, sqrt(10)/10;-sqrt(10)/10, (3sqrt(10))/10)mat(sqrt(60),0,0;0,sqrt(50),0) mat(-2/sqrt(6),1/sqrt(6),1/sqrt(6);1/sqrt(5),0,2/sqrt(5);2/sqrt(30),5/sqrt(30),-1/sqrt(30))-"полное разложение"
$
]
#pagebreak()

#problem(name: 9)[
Найти усечённое сингулярное разложение вектора-строки.
]
#solution[
Пусть $A-$ исходный вектор-строка, тогда $A A^T=a in RR$, число $sqrt(a)$ будет сингулярным значением, при этом $U$ в соответствии с алгоритмом получится единичной порядка 1, $Sigma=display(mat(sqrt(a)))$. $v_i=display((A^T dot 1)/sqrt(a))$. Значит итоговое $S V D$ будет иметь вид:
$
  A= mat(1) dot mat(sqrt(A A^T)) dot (A^T/sqrt(A A^T))^T
$
]
#answer[
$
  A= mat(1) dot mat(sqrt(A A^T)) dot (A^T/sqrt(A A^T))^T
$
]
#pagebreak()

#problem(name: 10)[
Рассмотрим матрицу $A in "Mat"_(n times 2)(RR)$ и обозначим через $a_1, a_2$ её столбцы. Пусть $sigma_1 >= sigma_2-$ сингулярные значения матрицы $A$. Доказать, что
$
  sigma_1 >= abs(a_1) >= sigma_2 " и " sigma_1 >= abs(a_2) >= sigma_2.
$
]
#solution[
Сингулярные значения есть есть корни из собственных значений матрицы $A^T A=display(mat(abs(a_1)^2, (a_1, a_2);(a_2,a_1), abs(a_2)^2))$
$
  chi(t)=det(mat(abs(a_1)^2-t, (a_1, a_2);(a_2,a_1), abs(a_2)^2-t))=t^2-t(abs(a_1)^2+abs(a_2)^2)+(abs(a_1)^2 dot abs(a_2)^2-(a_1,a_2)^2)
$
Из теоремы Виета имеем:
$
  cases(sigma_1^2+sigma_2^2=abs(a_1)^2+abs(a_2)^2,sigma_1^2 dot sigma_2^2=abs(a_1)^2 dot abs(a_2)^2-(a_1,a_2)^2)
$

]